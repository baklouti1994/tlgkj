<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Marwen Baklouti" />


<title>Bayesian approach for estimation of Exponential Change Point Model for the Evolution of TND Vs EUR</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}

.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Baklouti Marouan</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Contact me
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://www.kaggle.com/marwenbak">kaggle</a>
    </li>
    <li>
      <a href="https://github.com/baklouti1994">
        <span class="fa fa-github"></span>
         
      </a>
    </li>
    <li>
      <a href="mailto:baklouti.marouane@gmail.com">
        <span class="fa fa-envelope"></span>
         
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    My Work
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bayesian.html">Kernels</a>
    </li>
    <li>
      <a href="shinyapps.html">Shiny Apps</a>
    </li>
    <li>
      <a href="internships.html">Internships</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://www.cjoint.com/doc/18_11/HKDwIRgn27o_Curriculum-Vitae-3-.pdf">CV</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Bayesian approach for estimation of Exponential Change Point Model for the Evolution of TND Vs EUR</h1>
<h4 class="author"><em>Marwen Baklouti</em></h4>
<h4 class="date"><em>November 16 , 2018</em></h4>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction :</a></li>
<li><a href="#data-visualisation-and-plots">Data Visualisation and plots :</a></li>
<li><a href="#statistical-model">Statistical Model</a></li>
<li><a href="#openbugs"><code>OpenBUGS</code></a></li>
<li><a href="#gibbs-sampler">Gibbs sampler</a></li>
<li><a href="#fitting-data-to-the-model">Fitting Data to the model :</a></li>
<li><a href="#compiling-model-with-r-toopenbugs">Compiling model with R ToOpenBUGS :</a></li>
<li><a href="#convergence-of-the-markov-chains">convergence of the Markov Chains:</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction :</h2>
<p>Since 2017 , We Hear that The value of the Tunisian Dinar is falling behind in the face of the Euro and other currencies. In this article we will proceed with bayesian approach to detect the change year where the leap between the dinar and Euro had happened.</p>
</div>
<div id="data-visualisation-and-plots" class="section level2">
<h2>Data Visualisation and plots :</h2>
<pre class="r"><code>library(ggplot2)
library(plotly)

colnames(basefinale)=c(&quot;rowcount&quot;,&quot;Date&quot;,&quot;price&quot;)
head(basefinale)</code></pre>
<pre><code>## # A tibble: 6 x 3
##   rowcount Date       price
##      &lt;int&gt; &lt;date&gt;     &lt;dbl&gt;
## 1        1 2018-10-01  3.31
## 2        2 2018-09-01  3.25
## 3        3 2018-08-01  3.20
## 4        4 2018-07-01  3.15
## 5        5 2018-06-01  3.10
## 6        6 2018-05-01  3.05</code></pre>
<pre class="r"><code>p&lt;-ggplot(basefinale,aes(x=Date,y=price))+geom_line()+theme_bw()
ggplotly(p)</code></pre>
<p><div id="htmlwidget-52f54d26dce67b170319" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-52f54d26dce67b170319">{"x":{"data":[{"x":[13514,13545,13573,13604,13634,13665,13695,13726,13757,13787,13818,13848,13879,13910,13939,13970,14000,14031,14061,14092,14123,14153,14184,14214,14245,14276,14304,14335,14365,14396,14426,14457,14488,14518,14549,14579,14610,14641,14669,14700,14730,14761,14791,14822,14853,14883,14914,14944,14975,15006,15034,15065,15095,15126,15156,15187,15218,15248,15279,15309,15340,15371,15400,15431,15461,15492,15522,15553,15584,15614,15645,15675,15706,15737,15765,15796,15826,15857,15887,15918,15949,15979,16010,16040,16071,16102,16130,16161,16191,16222,16252,16283,16314,16344,16375,16405,16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805],"y":[1.7085,1.7241,1.7351,1.7589,1.7527,1.7559,1.7539,1.7473,1.777,1.7854,1.7926,1.7935,1.7961,1.8088,1.8139,1.8204,1.8251,1.8376,1.8313,1.8088,1.7833,1.7516,1.77,1.8336,1.8229,1.8403,1.8547,1.8575,1.9057,1.8946,1.8883,1.8888,1.8967,1.9133,1.9226,1.894,1.8825,1.8957,1.8948,1.9014,1.8563,1.8604,1.9022,1.8905,1.9397,1.9446,1.9037,1.8769,1.9316,1.9464,1.9653,1.9977,1.9667,1.9804,1.9708,1.9692,1.9253,1.9578,1.9665,1.9384,1.9774,1.9945,2.0047,2.029,1.9962,2.0037,1.9891,2.0113,2.0282,2.0406,2.0476,2.0481,2.0878,2.0692,2.0465,2.1147,2.1337,2.1509,2.195,2.1883,2.2298,2.2429,2.2634,2.2618,2.1654,2.174,2.1783,2.2182,2.225,2.3035,2.307,2.2868,2.2771,2.2872,2.2923,2.2591,2.1849,2.1833,2.109,2.1416,2.1551,2.1782,2.1639,2.192,2.2016,2.1944,2.1786,2.213,2.22,2.2306,2.2942,2.2847,2.3546,2.429,2.468,2.4645,2.468,2.4676,2.4484,2.4202,2.4758,2.4413,2.4325,2.6848,2.7555,2.8165,2.8183,2.8963,2.9275,2.9061,2.9691,2.9461,3.0086,2.9327,2.9558,3.0172,3.0528,3.0952,3.1464,3.202,3.2532,3.3103],"text":["Date: 2007-01-01<br />price: 1.7085","Date: 2007-02-01<br />price: 1.7241","Date: 2007-03-01<br />price: 1.7351","Date: 2007-04-01<br />price: 1.7589","Date: 2007-05-01<br />price: 1.7527","Date: 2007-06-01<br />price: 1.7559","Date: 2007-07-01<br />price: 1.7539","Date: 2007-08-01<br />price: 1.7473","Date: 2007-09-01<br />price: 1.7770","Date: 2007-10-01<br />price: 1.7854","Date: 2007-11-01<br />price: 1.7926","Date: 2007-12-01<br />price: 1.7935","Date: 2008-01-01<br />price: 1.7961","Date: 2008-02-01<br />price: 1.8088","Date: 2008-03-01<br />price: 1.8139","Date: 2008-04-01<br />price: 1.8204","Date: 2008-05-01<br />price: 1.8251","Date: 2008-06-01<br />price: 1.8376","Date: 2008-07-01<br />price: 1.8313","Date: 2008-08-01<br />price: 1.8088","Date: 2008-09-01<br />price: 1.7833","Date: 2008-10-01<br />price: 1.7516","Date: 2008-11-01<br />price: 1.7700","Date: 2008-12-01<br />price: 1.8336","Date: 2009-01-01<br />price: 1.8229","Date: 2009-02-01<br />price: 1.8403","Date: 2009-03-01<br />price: 1.8547","Date: 2009-04-01<br />price: 1.8575","Date: 2009-05-01<br />price: 1.9057","Date: 2009-06-01<br />price: 1.8946","Date: 2009-07-01<br />price: 1.8883","Date: 2009-08-01<br />price: 1.8888","Date: 2009-09-01<br />price: 1.8967","Date: 2009-10-01<br />price: 1.9133","Date: 2009-11-01<br />price: 1.9226","Date: 2009-12-01<br />price: 1.8940","Date: 2010-01-01<br />price: 1.8825","Date: 2010-02-01<br />price: 1.8957","Date: 2010-03-01<br />price: 1.8948","Date: 2010-04-01<br />price: 1.9014","Date: 2010-05-01<br />price: 1.8563","Date: 2010-06-01<br />price: 1.8604","Date: 2010-07-01<br />price: 1.9022","Date: 2010-08-01<br />price: 1.8905","Date: 2010-09-01<br />price: 1.9397","Date: 2010-10-01<br />price: 1.9446","Date: 2010-11-01<br />price: 1.9037","Date: 2010-12-01<br />price: 1.8769","Date: 2011-01-01<br />price: 1.9316","Date: 2011-02-01<br />price: 1.9464","Date: 2011-03-01<br />price: 1.9653","Date: 2011-04-01<br />price: 1.9977","Date: 2011-05-01<br />price: 1.9667","Date: 2011-06-01<br />price: 1.9804","Date: 2011-07-01<br />price: 1.9708","Date: 2011-08-01<br />price: 1.9692","Date: 2011-09-01<br />price: 1.9253","Date: 2011-10-01<br />price: 1.9578","Date: 2011-11-01<br />price: 1.9665","Date: 2011-12-01<br />price: 1.9384","Date: 2012-01-01<br />price: 1.9774","Date: 2012-02-01<br />price: 1.9945","Date: 2012-03-01<br />price: 2.0047","Date: 2012-04-01<br />price: 2.0290","Date: 2012-05-01<br />price: 1.9962","Date: 2012-06-01<br />price: 2.0037","Date: 2012-07-01<br />price: 1.9891","Date: 2012-08-01<br />price: 2.0113","Date: 2012-09-01<br />price: 2.0282","Date: 2012-10-01<br />price: 2.0406","Date: 2012-11-01<br />price: 2.0476","Date: 2012-12-01<br />price: 2.0481","Date: 2013-01-01<br />price: 2.0878","Date: 2013-02-01<br />price: 2.0692","Date: 2013-03-01<br />price: 2.0465","Date: 2013-04-01<br />price: 2.1147","Date: 2013-05-01<br />price: 2.1337","Date: 2013-06-01<br />price: 2.1509","Date: 2013-07-01<br />price: 2.1950","Date: 2013-08-01<br />price: 2.1883","Date: 2013-09-01<br />price: 2.2298","Date: 2013-10-01<br />price: 2.2429","Date: 2013-11-01<br />price: 2.2634","Date: 2013-12-01<br />price: 2.2618","Date: 2014-01-01<br />price: 2.1654","Date: 2014-02-01<br />price: 2.1740","Date: 2014-03-01<br />price: 2.1783","Date: 2014-04-01<br />price: 2.2182","Date: 2014-05-01<br />price: 2.2250","Date: 2014-06-01<br />price: 2.3035","Date: 2014-07-01<br />price: 2.3070","Date: 2014-08-01<br />price: 2.2868","Date: 2014-09-01<br />price: 2.2771","Date: 2014-10-01<br />price: 2.2872","Date: 2014-11-01<br />price: 2.2923","Date: 2014-12-01<br />price: 2.2591","Date: 2015-01-01<br />price: 2.1849","Date: 2015-02-01<br />price: 2.1833","Date: 2015-03-01<br />price: 2.1090","Date: 2015-04-01<br />price: 2.1416","Date: 2015-05-01<br />price: 2.1551","Date: 2015-06-01<br />price: 2.1782","Date: 2015-07-01<br />price: 2.1639","Date: 2015-08-01<br />price: 2.1920","Date: 2015-09-01<br />price: 2.2016","Date: 2015-10-01<br />price: 2.1944","Date: 2015-11-01<br />price: 2.1786","Date: 2015-12-01<br />price: 2.2130","Date: 2016-01-01<br />price: 2.2200","Date: 2016-02-01<br />price: 2.2306","Date: 2016-03-01<br />price: 2.2942","Date: 2016-04-01<br />price: 2.2847","Date: 2016-05-01<br />price: 2.3546","Date: 2016-06-01<br />price: 2.4290","Date: 2016-07-01<br />price: 2.4680","Date: 2016-08-01<br />price: 2.4645","Date: 2016-09-01<br />price: 2.4680","Date: 2016-10-01<br />price: 2.4676","Date: 2016-11-01<br />price: 2.4484","Date: 2016-12-01<br />price: 2.4202","Date: 2017-01-01<br />price: 2.4758","Date: 2017-02-01<br />price: 2.4413","Date: 2017-03-01<br />price: 2.4325","Date: 2017-04-01<br />price: 2.6848","Date: 2017-05-01<br />price: 2.7555","Date: 2017-06-01<br />price: 2.8165","Date: 2017-07-01<br />price: 2.8183","Date: 2017-08-01<br />price: 2.8963","Date: 2017-09-01<br />price: 2.9275","Date: 2017-10-01<br />price: 2.9061","Date: 2017-11-01<br />price: 2.9691","Date: 2017-12-01<br />price: 2.9461","Date: 2018-01-01<br />price: 3.0086","Date: 2018-02-01<br />price: 2.9327","Date: 2018-03-01<br />price: 2.9558","Date: 2018-04-01<br />price: 3.0172","Date: 2018-05-01<br />price: 3.0528","Date: 2018-06-01<br />price: 3.0952","Date: 2018-07-01<br />price: 3.1464","Date: 2018-08-01<br />price: 3.2020","Date: 2018-09-01<br />price: 3.2532","Date: 2018-10-01<br />price: 3.3103"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[13299.45,18019.55],"tickmode":"array","ticktext":["2008","2010","2012","2014","2016","2018"],"tickvals":[13879,14610,15340,16071,16801,17532],"categoryorder":"array","categoryarray":["2008","2010","2012","2014","2016","2018"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"Date","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1.62841,3.39039],"tickmode":"array","ticktext":["2.0","2.5","3.0"],"tickvals":[2,2.5,3],"categoryorder":"array","categoryarray":["2.0","2.5","3.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"price","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"354609d67aa":{"x":{},"y":{},"type":"scatter"}},"cur_data":"354609d67aa","visdat":{"354609d67aa":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script> SO while observing this chart we can detect that exchage rate’s evolution has made a leap after the tunisian revolution in 2011 So by doing a bayesian approch with using Gibbs Sapmler, we will estimate that change date and we will estimate the exponential distribution of the exchange rate before and after the change point</p>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
</div>
<div id="statistical-model" class="section level2">
<h2>Statistical Model</h2>
<p>Suppose that we had collected the same quantitative data in two diffrent periods: <span class="math display">\[y_1^1,\ldots,y_{n_1}^1\]</span> and <span class="math display">\[y_1^2,\ldots,y_{n_2}^2\]</span> Since our aim is to compare the average of both groups by assuming that both of them are sampled from an univariate Exponential distribution with means respectively <span class="math inline">\(\mu^1\)</span> and <span class="math inline">\(\mu^2\)</span> .</p>
<p>Since we don’t have any solid prior information on the parameters we will then choose flat priors on the parameters.</p>
<p>Hence our Bayesian Statistical Model is defined as follows</p>
<p><span class="math display">\[y_1^1,\ldots,y_{n_1}^1\sim\mathcal{exp}(\mu^1)\]</span> and <span class="math display">\[y_1^2,\ldots,y_{n_2}^2\sim\mathcal{exp}(\mu^2)\]</span> where <span class="math display">\[\pi(\mu^1,\mu^2)\propto \mathbb{1}_{\mathbb{R}^2}(\mu^1,\mu^2)\,\mathbb{1}_{\mathbb{R}^*_+}(\tau)\]</span></p>
</div>
<div id="openbugs" class="section level2">
<h2><code>OpenBUGS</code></h2>
<ul>
<li><p>This software is part of the BUGS project (Bayesian inference Using Gibbs Sampler) that aims to facilitate the use of MCMC methods for Bayesian Statistics. It’s developed by MRC Biostatistics of Cambridge University.</p></li>
<li><p><code>OpenBUGS</code> is a free software.</p></li>
<li><p><code>OpenBUGS</code> has a simple GUI with predefined models that can be constructed using <code>DoodleBUGS</code>.</p></li>
<li><p>We can also use <code>OpenBUGS</code> from <code>R</code> using <code>R2OpenBUGS</code> package.</p></li>
<li><p><code>OpenBUGS</code> is based then on the Gibbs Sampler Algorithm.</p></li>
</ul>
</div>
<div id="gibbs-sampler" class="section level2">
<h2>Gibbs sampler</h2>
<p><strong>What’s a Gibbs Sampler</strong></p>
<ul>
<li><p>It’s an algorithm for simulating Markov chains.</p></li>
<li><p>Let <span class="math inline">\(\theta=(\theta_1,\ldots,\theta_k)\)</span> be a random vector with joint distribution <span class="math inline">\(f\)</span>,</p></li>
<li><p><em>Aim</em>: simulate a sample with distribution <span class="math inline">\(f\)</span>.</p></li>
</ul>
<p><strong>How it works?</strong></p>
<ol style="list-style-type: decimal">
<li><p>Choose arbitrary starting values: <span class="math inline">\(\theta^{(0)}=(\theta_1^{(0)},\ldots,\theta_k^{(0)})\)</span></p></li>
<li><p>Sample new values for each element of <span class="math inline">\(\theta\)</span> by cycling through the following steps:</p></li>
</ol>
<ul>
<li><p>Sample a new value for <span class="math inline">\(\theta_1^{(1)}\)</span> from the full <em>conditional distribution</em> of <span class="math inline">\(\theta_1\)</span> given the most recent values of all other elements of <span class="math inline">\(\theta\)</span>: <span class="math display">\[ \theta_1^{(1)}\sim p\left(\theta_1 \mid\theta_2^{(0)},\ldots,\theta_k^{(0)}  \right)\]</span></p></li>
<li><p>Sample a new value <span class="math inline">\(\theta_2^{(1)}\)</span> for the 2nd component of <span class="math inline">\(\theta\)</span>, from its full <em>conditional distribution</em> <span class="math display">\[ \theta_2^{(1)}\sim p\left(\theta_2 \mid\theta_1^{(1)},\theta_3^{(0)}\ldots,\theta_k^{(0)}  \right)\]</span></p></li>
<li>…</li>
<li><span class="math inline">\(\theta_k^{(1)}\sim p\left(\theta_1 \mid\theta_1^{(1)},\theta_2^{(1)}\ldots,\theta_{k-1}^{(1)} \right)\)</span></li>
<li><p>This completes one iteration of the Gibbs sampler and generates a new realization of the vector of unknowns <span class="math inline">\(\theta^{(1)}\)</span>.</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Repeat Step 2 many times and obtain a sample <span class="math inline">\(\theta^{(1)},\ldots, \theta^{(T)}\)</span></li>
</ol>
</div>
<div id="fitting-data-to-the-model" class="section level2">
<h2>Fitting Data to the model :</h2>
<ul>
<li>We suppose that <span class="math inline">\(\tau\)</span> is the change-point date and that before that date the exchange rate follows an exponenetial distribution with parameter <span class="math inline">\(\lambda_1\)</span> and it follows after $$ also a an exponential distribution with parameter <span class="math inline">\(\lambda_1 +\lambda_2\)</span>. We will expect that <span class="math inline">\(\lambda_1\)</span> &lt;0<br />
### Prior distribution : +For the mean parameters <span class="math inline">\(\theta=(\lambda_1,\lambda_2)\)</span> we will assume a non-informative distribution (Gaussian centered distribution with a tiny variance)</li>
<li>For the change date we will assume an uniform distribution from one of the observation.</li>
<li><span class="math inline">\(N\)</span> is the number of months from 2007 to 2018.</li>
</ul>
<p>Finally we get the the bayesian model :</p>
<pre class="r"><code>model {
      for (year in 1:N) {
           D[year] ~ dexp(mu[year])
           log(mu[year]) &lt;- b[1] + step(year - changeyear) * b[2]
      }
      for (j in 1:2) { b[j] ~ dnorm(0.0, 1.0E-6) }
      changeyear ~ dunif(1,N)
    }</code></pre>
</div>
<div id="compiling-model-with-r-toopenbugs" class="section level2">
<h2>Compiling model with R ToOpenBUGS :</h2>
<pre class="r"><code>sink(&#39;change year TND.txt&#39;)
cat(&quot;
    model {

    for (year in 1:142) {
    D[year] ~ dexp(mu[year])
    log(mu[year]) &lt;- b[1] + step(year - changeyear) * b[2]
    }
    for (j in 1:2) { b[j] ~ dnorm(0.0, 1.0E-6) }
    changeyear ~ dunif(1,142)
     
    }
    &quot;,fill=T)

sink()
dt&lt;-list(D=basefinale$price,N=N)
inits=function(){
  inits=list(b=rnorm(2),changeyear=sample(size = 1,x = 1:142))
}
## Params 
params&lt;-c(&quot;b&quot;,&quot;changeyear&quot;)
## Running the MC
library(R2OpenBUGS)
filename&lt;-&#39;change year TND.txt&#39;
outCPEXP &lt;-bugs(dt,inits(),params,filename,codaPkg=F,
                  n.thin =1, n.iter=2000,debug=T,
                  n.chains = 2,working.directory=getwd())</code></pre>
<pre><code>## Inference for Bugs model at &quot;change year TND.txt&quot;, 
## Current: 2 chains, each with 10000 iterations (first 5000 discarded), n.thin = 6
## Cumulative: n.sims = 10000 iterations saved
##             mean   sd  2.5%   25%   50%   75% 97.5% Rhat n.eff
## b[1]        -0.9  0.2  -1.3  -1.0  -0.9  -0.8  -0.6    1 10000
## b[2]         0.2  0.3  -0.3   0.1   0.2   0.4   0.7    1 10000
## changeyear  67.2 40.8   4.1  31.3  64.0 101.5 139.6    1 10000
## deviance   503.4  2.1 500.9 501.9 503.1 504.4 508.9    1 10000
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).
## 
## DIC info (using the rule, pD = Dbar-Dhat)
## pD = 2.5 and DIC = 506.0
## DIC is an estimate of expected predictive error (lower deviance is better).</code></pre>
<ul>
<li>So , when we apply this model , we obtain that the estimated change point is</li>
</ul>
<pre class="r"><code>basefinale$Date[61]</code></pre>
<pre><code>## [1] &quot;2013-10-01&quot;</code></pre>
</div>
<div id="convergence-of-the-markov-chains" class="section level2">
<h2>convergence of the Markov Chains:</h2>
<ul>
<li>We will start by showing the simulated markov chaines for the estimated parameters:</li>
</ul>
<p>For <span class="math inline">\(\lambda_1\)</span> :</p>
<pre class="r"><code>&gt; library(coda)
&gt; b1=mcmc(outexp$sims.array[,,1])
&gt; dim(b1)</code></pre>
<pre><code>## [1] 5000    2</code></pre>
<pre class="r"><code>&gt; matplot(b1,col=c(&quot;green&quot;,&quot;blue&quot;),type=&quot;l&quot;,ylab=expression(b_1))</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-7-1.png" width="672" /> For <span class="math inline">\(\lambda_2\)</span> :</p>
<pre class="r"><code>&gt; b2=mcmc(outexp$sims.array[,,2])
&gt; dim(b2)</code></pre>
<pre><code>## [1] 5000    2</code></pre>
<pre class="r"><code>&gt; matplot(b2,col=c(&quot;green&quot;,&quot;blue&quot;),type=&quot;l&quot;,ylab=expression(b_2))</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>For <span class="math inline">\(\tau\)</span> : We must mention that we work only with integers that are the row count of the real change year. We just need to see in the data Set</p>
<pre class="r"><code>&gt; changeyear=mcmc(outexp$sims.array[,,3])
&gt; dim(changeyear)</code></pre>
<pre><code>## [1] 5000    2</code></pre>
<pre class="r"><code>&gt; matplot(changeyear,col=c(&quot;green&quot;,&quot;blue&quot;),type=&quot;l&quot;,ylab=&quot;changeyear&quot;)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<ul>
<li><span class="math inline">\(\widehat{R}\)</span> or Gelman diagnostics</li>
<li>Or The <em>potential scale reduction factor</em>. It is calculated for each estimated parameter, together with upper and lower confidence limits. Approximate convergence is diagnosed when the upper limit is close to 1. For multivariate chains, a multivariate value is calculated that bounds above the potential scale reduction factor for any linear combination of the (possibly transformed) variables.</li>
</ul>
<p><span class="math inline">\(\widehat{R}\)</span> is greater than 1 and it declines to 1 when the number of iteration inscreases.</p>
<pre class="r"><code>&gt; library(coda)
&gt; gelman.diag(list(b1[,1],b1[,2]))</code></pre>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1          1</code></pre>
<pre class="r"><code>&gt; gelman.plot(list(changeyear[,1],changeyear[,2]))</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>&gt; gelman.diag(list(changeyear[,1],changeyear[,2]))</code></pre>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1          1</code></pre>
<pre class="r"><code>&gt; gelman.plot(list(changeyear[,1],changeyear[,2]))</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>&gt; gelman.diag(list(changeyear[,1],changeyear[,2]))</code></pre>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1          1</code></pre>
<pre class="r"><code>&gt; gelman.plot(list(b1[,1],b1[,2]))</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<ul>
<li>Autocorrelation</li>
</ul>
<pre class="r"><code>&gt; autocorr.diag(b1)</code></pre>
<pre><code>##               [,1]         [,2]
## Lag 0   1.00000000  1.000000000
## Lag 1   0.05572071  0.057997050
## Lag 5   0.01348499 -0.005198583
## Lag 10 -0.01506722 -0.006247462
## Lag 50  0.02264373 -0.034243255</code></pre>
<pre class="r"><code>&gt; autocorr.diag(b2)</code></pre>
<pre><code>##               [,1]        [,2]
## Lag 0   1.00000000  1.00000000
## Lag 1   0.02406325  0.04705676
## Lag 5   0.02184948 -0.01975460
## Lag 10 -0.01038318 -0.01427291
## Lag 50  0.01274389 -0.02413436</code></pre>
<pre class="r"><code>&gt; autocorr.diag(changeyear)</code></pre>
<pre><code>##               [,1]         [,2]
## Lag 0   1.00000000  1.000000000
## Lag 1   0.04006403  0.050904868
## Lag 5   0.01556535 -0.004731193
## Lag 10 -0.01579686 -0.005015111
## Lag 50 -0.01224499 -0.012625712</code></pre>
<pre class="r"><code>&gt; autocorr.plot(b1)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code>&gt; autocorr.plot(b2)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-17-2.png" width="672" /></p>
<pre class="r"><code>&gt; autocorr.plot(changeyear)</code></pre>
<p><img src="bayesian_files/figure-html/unnamed-chunk-17-3.png" width="672" /></p>
<ul>
<li>As we can see from the autocorellation graphs and By choosing n.thin = 6, we can take off the autocorrelation of the simulation obsevation</li>
</ul>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
